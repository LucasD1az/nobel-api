<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Nobel API – Admin</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 20px;
      background: #f5f5f5;
    }
    h1 {
      margin-bottom: 0.2rem;
    }
    .card {
      background: #ffffff;
      padding: 16px;
      margin-bottom: 16px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06);
    }
    label {
      display: block;
      margin-top: 8px;
      font-weight: 600;
    }
    input[type="text"],
    input[type="number"],
    textarea {
      width: 100%;
      padding: 6px 8px;
      margin-top: 4px;
      box-sizing: border-box;
      border-radius: 4px;
      border: 1px solid #ccc;
    }
    button {
      margin-top: 12px;
      padding: 8px 16px;
      border-radius: 4px;
      border: none;
      cursor: pointer;
      background: #2563eb;
      color: white;
      font-weight: 600;
    }
    button:hover {
      background: #1d4ed8;
    }
    .error {
      color: #b91c1c;
      font-weight: 600;
    }
    .muted {
      color: #6b7280;
      font-size: 0.85rem;
    }
    .admin-card {
      border: 1px solid #e5e7eb;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 10px;
      background: #f9fafb;
    }
    .inline {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .inline > div {
      flex: 1 1 160px;
    }
    a {
      color: #2563eb;
      text-decoration: none;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <h1>Nobel API – Administración</h1>
  <p class="muted">
    Cliente web para operaciones protegidas (POST / PUT / DELETE) sobre el servidor Nobel.
    <br>
    Volver al cliente de consulta: <a href="/">/</a>
  </p>

  {% if error %}
    <p class="error">{{ error }}</p>
  {% endif %}

  <!-- Crear laureado -->
  <div class="card">
    <h2>Crear laureado nuevo</h2>
    <p class="muted">Este formulario llama al servidor con <code>POST /laureates</code> usando Basic Auth.</p>

    <form action="/admin/create" method="post">
      <label>Nombre completo (fullName)</label>
      <input type="text" name="fullName" required>

      <label>Género (gender)</label>
      <input type="text" name="gender" value="unknown">

      <label>Fecha de nacimiento (birthDate, ej. 1970-01-01)</label>
      <input type="text" name="birthDate">

      <label>Ciudad de nacimiento (birthCity)</label>
      <input type="text" name="birthCity">

      <label>País de nacimiento (birthCountry)</label>
      <input type="text" name="birthCountry">

      <h3>Primer premio Nobel asociado</h3>

      <div class="inline">
        <div>
          <label>Año del premio (awardYear)</label>
          <input type="number" name="awardYear" required>
        </div>
        <div>
          <label>Categoría (category)</label>
          <input type="text" name="category" value="Physics">
        </div>
      </div>

      <label>Motivación (motivation)</label>
      <textarea name="motivation" rows="3">Demo Nobel creado desde el cliente</textarea>

      <button type="submit">Crear laureado</button>
    </form>

    {% if created %}
      <h3>Laureado creado</h3>
      <div class="admin-card">
        <p><strong>ID:</strong> {{ created.id }}</p>
        <p><strong>Nombre:</strong> {{ created.fullName }}</p>
        <p><strong>País de nacimiento:</strong> {{ created.birthCountry }}</p>
      </div>
    {% endif %}
  </div>

  <!-- Buscar / editar / borrar -->
  <div class="card">
    <h2>Buscar laureado para editar / borrar</h2>
    <p class="muted">
      Se llama al servidor con <code>GET /laureates/search?name=...</code> y se muestran
      formularios para <code>PUT</code> y <code>DELETE</code>.
    </p>

    <form action="/admin/search" method="post">
      <label>Nombre (o parte del nombre)</label>
      <input type="text" name="search_name" required>
      <button type="submit">Buscar</button>
    </form>

    {% if search_results %}
      <h3>Resultados de búsqueda</h3>
      {% for l in search_results %}
        <div class="admin-card">
          <p><strong>ID:</strong> {{ l.id }}</p>
          <p><strong>Nombre:</strong> {{ l.fullName }}</p>

          <form action="/admin/update" method="post">
            <input type="hidden" name="id" value="{{ l.id }}">

            <label>Nombre completo (fullName)</label>
            <input type="text" name="fullName" value="{{ l.fullName }}">

            <label>Género (gender)</label>
            <input type="text" name="gender" value="{{ l.gender }}">

            <label>Fecha de nacimiento (birthDate)</label>
            <input type="text" name="birthDate" value="{{ l.birthDate }}">

            <label>Ciudad de nacimiento (birthCity)</label>
            <input type="text" name="birthCity" value="{{ l.birthCity }}">

            <label>País de nacimiento (birthCountry)</label>
            <input type="text" name="birthCountry" value="{{ l.birthCountry }}">

            <button type="submit">Actualizar (PUT)</button>
          </form>

          <form action="/admin/delete" method="post">
            <input type="hidden" name="id" value="{{ l.id }}">
            <button type="submit">Borrar (DELETE)</button>
          </form>
        </div>
      {% endfor %}
    {% endif %}

    {% if updated %}
      <h3>Laureado actualizado</h3>
      <div class="admin-card">
        <p><strong>ID:</strong> {{ updated.id }}</p>
        <p><strong>Nombre:</strong> {{ updated.fullName }}</p>
        <p><strong>País de nacimiento:</strong> {{ updated.birthCountry }}</p>
      </div>
    {% endif %}

    {% if deleted %}
      <h3>Laureado eliminado</h3>
      <div class="admin-card">
        <p><strong>ID:</strong> {{ deleted.id }}</p>
        <p><strong>Nombre:</strong> {{ deleted.fullName }}</p>
      </div>
    {% endif %}
  </div>
</body>
</html>
